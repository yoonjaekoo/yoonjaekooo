<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>클릭 횟수 게임</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>클릭 횟수 게임</h1>
  <button id="clickBtn">누를 때마다 +1</button>
  <p>현재 클릭: <span id="current">0</span></p>
  <p>최고 기록: <span id="best">0</span></p>

  <script>
    const supabaseUrl = 'https://koo131207.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im96ZnNwZHVsemtjamZ1aHhweGRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyNDMyODMsImV4cCI6MjA2OTgxOTI4M30.aWNRfnlcgtXwJPX4qYsHzIbbX7E_J9Zq_xsLRt_z2Es';
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
    const { data, error } = await supabaseClient.from('clicks').select('*');
    let count = 0;
    let best = 0;

    const currentEl = document.getElementById('current');
    const bestEl = document.getElementById('best');
    const button = document.getElementById('clickBtn');

    button.addEventListener('click', async () => {
      count++;
      currentEl.textContent = count;

      if (count > best) {
        best = count;
        bestEl.textContent = best;

        const { error } = await supabase
          .from('clicks')
          .upsert([{ id: 1, best_clicks: best }]);

        if (error) {
          console.error('Supabase 저장 오류:', error.message);
        }
      }
    });

    (async () => {
      const { data, error } = await supabase
        .from('clicks')
        .select('best_clicks')
        .eq('id', 1)
        .single();

      if (data) {
        best = data.best_clicks;
        bestEl.textContent = best;
      } else if (error) {
        console.error('Supabase 불러오기 오류:', error.message);
      }
    })();
  </script>
</body>
</html>


